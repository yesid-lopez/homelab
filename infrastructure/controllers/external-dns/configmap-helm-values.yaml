apiVersion: v1
kind: ConfigMap
metadata:
  name: external-dns-helm-chart-value-overrides
  namespace: external-dns
data:
  values.yaml: |-
    # External DNS Provider Configuration
    provider: webhook

    sources:
      - ingress
      - service
    
    # Logging and Monitoring
    logLevel: debug
    logFormat: text
    
    # Update Configuration
    interval: 1m
    
    # DNS Record Management Policy
    policy: sync
    
    # Registry Configuration
    registry: txt
    txtOwnerId: k3s-homelab
    txtPrefix: ""
    txtSuffix: ""

    # Sidecar container for netcup webhook provider
    sidecars:
      - name: external-dns-webhook-provider
        image: ghcr.io/fcomuniz/external-dns-porkbun-webhook:main
        imagePullPolicy: Always
        args:
          - --log-level=debug
          - --domain-filter=yesidlopez.de
        env:
          - name: PORKBUN_API_KEY
            valueFrom:
              secretKeyRef:
                name: porkbun-credentials
                key: PORKBUN_API_KEY
          - name: PORKBUN_API_SECRET
            valueFrom:
              secretKeyRef:
                name: porkbun-credentials
                key: PORKBUN_API_SECRET
        ports:
          - containerPort: 8888
            name: webhook
            protocol: TCP


